\documentclass[11pt]{article}
\usepackage{fullpage}
\usepackage{url}
\usepackage{amsmath}
\begin{document}
\thispagestyle{empty}
\parindent 0pt
\vfill
\large

\begin{center}
\LARGE{\bf \textsf{CS246: Mining Massive Datasets}}\\ {\bf \textsf{Homework 1}}
\\*[4ex]
\end{center}

\section*{Answer to Question 1}
Here is a brief description of the algorithm:\\
\\
\textbf{Map:}\\
At this step for each line of data, assume there is a simple line of data like this:
$$
    (N_{i}: N_{j}, N_{k}, N_{m})
$$
Take its values and construct pairs, those pairs represents they share the same friend $N_i$. Then we construct:
$$
 (N_j: (N_k, 1)), (N_j: (N_m, 1)), (N_k: (N_j, 1)), (N_k: (N_m, 1)), (N_m: (N_j, 1)), (N_m: (N_k, 1))
$$
Here $1$ means, the value can be recommended to the key. Since there may have possibility that they are already friends,
therefore based on this line we can construct:
$$
 (N_i:(N_j, 0)), (N_i:(N_k, 0)), (N_i:(N_m, 0))
$$
Here $0$ means the value cannot be recommended to the key.\\
\\
\textbf{Reduce:}\\
Each reducer has two tasks to do. For the value tuples,
if the value contains $1$ this value will be added to a hash table and count how many this value appears.
On the other hand if the value tuple contains $0$, this value will be added to a set.
This set keeps a record who is already a friend of the key.
After iterate all the value tuple, name in the set will be excluded from the hash table.\\
\\
The hash table will in the end be sorted and output its top 10 records.\\
\\
924	6995,45881,439,43748,2409,15416,11860\\
8941 8944,8943,8940\\
8942 8939,8944,8943,8940\\
9019	9022,9023,317\\
9020	9021,9022,9017,9016,9023,317\\
9021	9020,9022,9017,9016,9023,317\\
9022	9021,9020,9019,9023,9017,9016,317\\
9990	37941,34642,34485,34299,13877,13478,13134\\
9992	9989,9987,35667,9991\\
9993	9991,37941,34642,34485,34299,13877,13478,13134\\

\pagebreak[4]
\section*{Answer to Question 2(a)}
Ignoring $Pr(B)$ can lead to recommen items that are not very frequent;
or item $B$ has very high support then it shows up in nearly every basket.
If this item has very high support confidence $conf(A\rightarrow B)$ is not very useful.\\
\\
While lift and conviction consider support in their formula. When $Pr(B)$ gets higher,
there will be a high support $S(B)$. Then $lift(A\rightarrow B) = \frac{conf(A\rightarrow B)}{S(B)}$
will get a smaller value. Conviction is similar, a high support value $S(B)$ will make conviction smaller.
Therefore, both conviction and lift consider $Pr(B)$ and reflects how offer $A$ and $B$ are together due to the existence of $A$.

\pagebreak[4]
\section*{Answer to Question 2(b)}
\textbf{confidence: }\\
\begin{equation}
    conf(A\rightarrow B) = Pr(B|A)
\end{equation}
\begin{equation}
    conf(B\rightarrow A) = Pr(A|B)
\end{equation}
It is very easy to see they are not necessarily the same.
For example there are two baskets $\{A, B\}, \{A\}$ and assume $N=1$.
$conf(A\rightarrow B) = 0.5$ and $conf(B\rightarrow A) = 1$.
Confidence is not symmetrical.\\
\\
\textbf{lift: }
\begin{equation}
\begin{aligned}
    lift(A\rightarrow B) & = \frac{conf(A\rightarrow B)}{S(B)}\\
    & = \frac{Pr(B|A)}{Support(B)/N}\\
    & = \frac{Support(AB)/Support(A)}{Support(B)/N} = \frac{Support(AB)/Support(B)}{Support(A)/N}\\
    & = \frac{Pr(A|B)}{Support(A)/N}\\
    & = \frac{conf(B\rightarrow A)}{S(A)}\\
    & = lift(B\rightarrow A)
\end{aligned}
\end{equation}
Therefore lift is symmetrical.\\
\\
\textbf{conviction: }
\begin{equation}
\begin{aligned}
    conviction(A\rightarrow B) & = \frac{1 - support(B)/N}{1 - conf(A\rightarrow B)}\\
    & = \frac{1 - support(B)/N}{1 - Pr(B|A)}\\
    & = \frac{1 - support(B)/N}{1 - Support(AB)/Support(A)}
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
    conviction(B\rightarrow A) & = \frac{1 - support(A)/N}{1 - conf(B\rightarrow A)}\\
    & = \frac{1 - support(A)/N}{1 - Pr(A|B)}\\
    & = \frac{1 - support(A)/N}{1 - Support(AB)/Support(B)}
\end{aligned}
\end{equation}
It can be seen that above two equations do not necessarily equal to each other.
For example there are two baskets $\{A, B\}, \{A\}$ and assume $N=1$.
$conviction(A\rightarrow B) = 0$ and $conviction(B\rightarrow A) = -\infty$.
Therefore, conviction is not symmetrical.

\pagebreak[4]
\section*{Answer to Question 2(c)}
\textbf{confidence: }\\
\begin{equation}
    conf(A\rightarrow B) = Pr(B|A) = \frac{support(AB)}{support(A)}
\end{equation}
$support(AB) \leq support(A)$ and $conf(A\rightarrow B)$ gets its maxima only when $support(AB) = support(A)$.
This means this rules hold $100\%$ of the time. Therefore, confidence is desirable.\\
\\
\textbf{lift: }
\begin{equation}
\begin{aligned}
    lift(A\rightarrow B) & = \frac{conf(A\rightarrow B)}{S(B)}\\
    & = \frac{Pr(B|A)}{Support(B)/N}\\
    & = \frac{Support(AB)/Support(A)}{Support(B)/N}
\end{aligned}
\end{equation}
When the rules hold $100\%$ of the time, have $support(AB) = support(A)$.
If we assume $support(B)$ is fixed, then lift reach its maxima. Therefore, lift is desirable.
\\
\textbf{conviction: }
\begin{equation}
\begin{aligned}
    conviction(A\rightarrow B) & = \frac{1 - support(B)/N}{1 - conf(A\rightarrow B)}\\
    & = \frac{1 - support(B)/N}{1 - Pr(B|A)}\\
    & = \frac{1 - support(B)/N}{1 - Support(AB)/Support(A)}
\end{aligned}
\end{equation}
The same logic goes for conviction.
Assume $support(B)$ is fixed, $conviction(A\rightarrow B)$ increases with $support(A)$ increasing.
$conviction(A\rightarrow B)$ reaches its maxima when $support(AB) = support(A)$. This imply rules hold $100\%$ of the time.
Therefore, conviction is desirable.

\pagebreak[4]
\section*{Answer to Question 2(d)}
\begin{equation*}
\begin{aligned}
& conf(DAI93865\rightarrow FRO40251) = 1.0\\
& conf(GRO85051\rightarrow FRO40251) = 0.999176276771005\\
& conf(GRO38636\rightarrow FRO40251) = 0.9906542056074766)\\
& conf(ELE12951\rightarrow FRO40251) = 0.9905660377358491)\\
& conf(DAI88079\rightarrow FRO40251) = 0.9867256637168141)
\end{aligned}
\end{equation*}

\pagebreak[4]
\section*{Answer to Question 2(e)}
\begin{equation*}
\begin{aligned}
& conf(DAI23334,ELE92920\rightarrow DAI62779) = 1.0\\
& conf(DAI31081,GRO85051\rightarrow FRO40251) = 1.0\\
& conf(DAI55911,GRO85051\rightarrow FRO40251) = 1.0\\
& conf(DAI62779,DAI88079\rightarrow FRO40251) = 1.0\\
& conf(DAI75645,GRO85051\rightarrow FRO40251) = 1.0
\end{aligned}
\end{equation*}


\pagebreak[4]
\section*{Answer to Question 3(a)}
The probability of getting don`t know is:\\
\begin{equation}
    P = \frac{n-m}{n}\frac{n-m-1}{n-1}...\frac{n-m-k+1}{n-k+1} =\frac{\frac{(n-m)!}{(n-m-k)!}}{\frac{n!}{(n-k)!}}
\end{equation}
It is easy to see:
\begin{equation}
    P = \frac{\frac{(n-m)!}{(n-m-k)!}}{\frac{n!}{(n-k)!}} \leq (\frac{n-m}{n})^k
\end{equation}
Then let`s prove:
\begin{equation}
    (\frac{n-m}{n})^k \leq (\frac{n-k}{n})^m
\end{equation}
It can be rewriten as:
\begin{equation}
    (n-m)^k(n)^{m-k} \leq (n-k)^m
\end{equation}
Use the AMâ€“GM inequality and also given $m\geq k$:
\begin{equation}
    (n-m)^k(n)^{m-k} \leq (\frac{k(n-m)+(m-k)n}{m-k+k})^{m-k+k} = (n-k)^{m}
\end{equation}
Therefore, when $m=k$ this inequality gets its equal sign:
\begin{equation}
    P  \leq (\frac{n-m}{n})^k \leq (\frac{n-k}{n})^m
\end{equation}

\pagebreak[4]
\section*{Answer to Question 3(b)}
Use the result from 3(a) and assume:
\begin{equation*}
    P = (\frac{n-k}{n})^m = (1 - \frac{1}{n/k})^m = (1 - \frac{1}{n/k})^{n/k\frac{m}{n/k}}
\end{equation*}
Since $n$ is much larger than $k$, therefore we can approximate as following:
\begin{equation*}
    P = (\frac{n-k}{n})^m = (1 - \frac{1}{n/k})^{n/k\frac{m}{n/k}} \approx e^{-\frac{m}{n/k}}
\end{equation*}
Therefore,
\begin{equation*}
    -\frac{m}{n/k} = -10
\end{equation*}
\begin{equation}
    k = 10\frac{n}{m}
\end{equation}

\pagebreak[4]
\section*{Answer to Question 3(c)}
a) Below is an example of the matrix:
\begin{equation*}
\begin{bmatrix}
    1 & 1\\
    0 & 1\\
    1 & 0
\end{bmatrix}
\end{equation*}
b) The Jaccard Similarity for the two columns is $1/3$.\\
\\
c) There are three cyclic permutation and the resulting signatures of them are:
$(1, 1)$, $(3, 2)$ and $(3, 1)$. As can be seen only one of them has the same minhash value.
Therefore, the probability is $1/3$

\pagebreak[4]
\section*{Answer to Question 4(a)}

\pagebreak[4]
\section*{Answer to Question 4(b)}

\pagebreak[4]
\section*{Answer to Question 4(c)}

\pagebreak[4]
\section*{Answer to Question 4(d)}

\pagebreak[4]
\section*{Continued Answer to Question 4(d)}

\pagebreak[4]
\begin{center}
\LARGE{\bf \textsf{Cover Sheet}} \\*[4ex]
\end{center}

\textbf{Assignment Submission } Fill in and include this cover sheet with each of your assignments. Assignments are due at 11:59pm. All students (SCPD and non-SCPD) must submit their homeworks via GradeScope (\url{http://www.gradescope.com}). Students can typeset or scan their homeworks. Make sure that you answer each question on a separate page. Students also need to upload their code at \url{http://snap.stanford.edu/submit}. Put all the code for a single question into a single file and upload it. Please do not put any code in your GradeScope submissions.
\\
\\
\textbf{Late Day Policy } Each student will have a total of {\em two} free late periods. {\em One late period expires at the start of each class.} (Homeworks are usually due on Thursdays, which means the first late periods expires on the following Tuesday.) Once these late periods are exhausted, any assignments turned in late will be penalized 50\% per late period. However, no assignment will be accepted more than {\em one} late period after its due date.
\\
\\
\textbf{Honor Code } We strongly encourage students to form study groups. Students may discuss and work on homework problems in groups. However, each student must write down their solutions independently i.e., each student must understand the solution well enough in order to reconstruct it by him/herself.  Students should clearly mention the names of all the other students who were part of their discussion group. Using code or solutions obtained from the web (github/google/previous year solutions etc.) is considered an honor code violation. We check all the submissions for plagiarism. We take the honor code very seriously and expect students to do the same.

\vfill
\vfill

{\Large
\textbf{Your name:} \hrulefill \\
\textbf{Email:} \underline{\hspace*{7cm}} \textbf{SUID:} \hrulefill\\*[2ex] }
Discussion Group (People with whom you discussed ideas used in your answers): \\\\\\
On-line or hardcopy documents used as part of your answers: \\\\\\
\vfill

\vfill

I acknowledge and accept the Honor Code.\\*[3ex]
\bigskip
\textit{(Signed)}\hrulefill
% If you are not printing this document out, just type your initials above

\vfill
\vfill

\end{document}

